!function(){"use strict";const e={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-button",inactiveButtonClass:"modal__submit-button_inactive",inputErrorClass:"modal__input_type_error",errorClass:"modal__error"},t=(e,t,r)=>{e.querySelector(`#${t.id}-error`).textContent="",t.classList.remove(r.inputErrorClass)},r=(e,t,r)=>{(e=>e.some((e=>!e.validity.valid)))(e)?n(t,r):(t.disabled=!1,t.classList.remove(r.inactiveButtonClass))},n=(e,t)=>{e.disabled=!0,e.classList.add(t.inactiveButtonClass)};function o(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Save",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Saving...";e.textContent=t?n:r}function a(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Saving...";t.preventDefault();const n=t.submitter,a=n.textContent;o(n,!0,a,r),e().then((()=>{t.target.reset()})).catch(console.error).finally((()=>{o(n,!1,a,r)}))}let c,s,i;const l=new class{constructor(e){let{baseUrl:t,headers:r}=e;this._baseUrl=t,this._headers=r}getAppInfo(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error ${e.status}`)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._checkResponse)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._checkResponse)}editUserInfo(e){let{name:t,about:r}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:r})}).then(this._checkResponse)}editAvatar(e){let{avatar:t}=e;return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t})}).then(this._checkResponse)}newCardPost(e){let{name:t,link:r}=e;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:r})}).then(this._checkResponse)}deleteCard(e){let{cardId:t}=e;return fetch(`${this._baseUrl}/cards/${t}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}handleLike(e){let{cardId:t,isLiked:r}=e;return fetch(`${this._baseUrl}/cards/${t}/likes`,{method:r?"DELETE":"PUT",headers:this._headers}).then(this._checkResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"affadb7a-4331-4fd2-8582-ffa1f1bc4b49","Content-Type":"application/json"}}),d=document.querySelector(".profile__edit-button"),u=document.querySelector(".profile__name"),m=document.querySelector(".profile__description"),h=document.querySelector(".profile__avatar img"),_=document.querySelector(".profile__avatar-button"),f=document.querySelector("#edit-profile-modal"),v=document.querySelector("#profile-name-input"),p=document.querySelector("#profile-description-input"),y=(f.querySelector(".modal__form"),document.forms["profile-form"]),S=document.querySelector("#edit-avatar-modal"),b=document.forms["avatar-form"],k=document.querySelector("#profile-picture-input"),q=document.querySelector(".profile__add-button"),E=document.querySelector("#new-post-modal"),L=document.forms["newPost-form"],g=document.querySelector("#newPost-link-input"),C=document.querySelector("#newPost-caption-input"),U=E.querySelector(".modal__submit-button"),I=document.querySelector("#delete-post-modal"),x=document.querySelectorAll(".modal__close"),A=document.querySelector("#preview-modal"),$=A.querySelector(".modal__image"),P=A.querySelector(".modal__caption"),w=document.querySelectorAll(".modal"),D=document.querySelector("#card-template"),R=document.querySelector(".cards__list"),T=I.querySelector(".modal__delete-button"),B=I.querySelector(".modal__cancel-button");function N(e){e.classList.add("modal_opened"),document.addEventListener("keydown",j)}function O(e){e.classList.remove("modal_opened"),document.removeEventListener("keydown",j)}function j(e){if("Escape"===e.key){const e=document.querySelector(".modal_opened");e&&O(e)}}function J(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"append";const r=function(e){const t=D.content.querySelector(".card").cloneNode(!0),r=t.querySelector(".card__title"),n=t.querySelector(".card__image"),o=t.querySelector(".card__like-button"),a=t.querySelector(".card__delete-button");return e.isLiked&&o.classList.add("card__like-button_clicked"),r.textContent=e.name,n.src=e.link,n.alt=e.name,o.addEventListener("click",(t=>{!function(e,t){const r=e.target,n=r.classList.contains("card__like-button_clicked");l.handleLike({cardId:t,isLiked:n}).then((e=>{e.isLiked?r.classList.add("card__like-button_clicked"):r.classList.remove("card__like-button_clicked")})).catch(console.error)}(t,e._id)})),a.addEventListener("click",(r=>{!function(e,t){s=e,i=t._id,console.log("Selected Card ID:",i),N(I)}(t,e)})),n.addEventListener("click",(()=>{N(A),P.textContent=e.name,$.src=e.link,P.alt=e.name})),t}(e);R[t](r)}var H;document.getElementById("spots-logo-black").src="8650253b58b46f0f1c06.svg",w.forEach((e=>{!function(e){e.addEventListener("click",(t=>{t.target===e&&O(e)}))}(e)})),x.forEach((e=>{const t=e.closest(".modal");e.addEventListener("click",(()=>O(t)))})),d.addEventListener("click",(()=>{var r,n;v.value=u.textContent,p.value=m.textContent,r=f,n=e,[v,p].forEach((e=>{t(r,e,n)})),N(f)})),q.addEventListener("click",(()=>{N(E)})),_.addEventListener("click",(()=>{N(S)})),y.addEventListener("submit",(function(e){a((function(){return l.editUserInfo({name:v.value,about:p.value}).then((e=>{u.textContent=e.name,m.textContent=e.about,O(f)}))}),e,"Saving...")})),L.addEventListener("submit",(function(t){a((function(){return l.newCardPost({link:g.value,name:C.value}).then((t=>{J(t,"prepend"),n(U,e),O(E)}))}),t,"Saving...")})),b.addEventListener("submit",(function(e){a((function(){return l.editAvatar({avatar:k.value}).then((e=>{h.src=e.avatar,h.alt=e.name,O(S)}))}),e,"Saving...")})),T.addEventListener("click",(function(e){e.preventDefault();const t=e.target;o(t,!0,"Delete","Deleting..."),l.deleteCard({cardId:i}).then((()=>{s.remove(),O(I)})).catch(console.error).finally((()=>{o(t,!1,"Delete","Deleting...")}))})),B.addEventListener("click",(()=>O(I))),l.getAppInfo().then((e=>{let[t,r]=e;u.textContent=r.name,m.textContent=r.about,h.src=r.avatar,h.alt=r.name,c=r._id,t.reverse().forEach((e=>{J(e)}))})).catch(console.error),H=e,Array.from(document.querySelectorAll(H.formSelector)).forEach((e=>{((e,o)=>{const a=Array.from(e.querySelectorAll(o.inputSelector)),c=e.querySelector(o.submitButtonSelector);r(a,c,o),e.addEventListener("reset",(()=>{n(c,o)})),a.forEach((n=>{n.addEventListener("input",(function(){((e,r,n)=>{r.validity.valid?t(e,r,n):((e,t,r,n)=>{e.querySelector(`#${t.id}-error`).textContent=r,t.classList.add(n.inputErrorClass)})(e,r,r.validationMessage,n)})(e,n,o),r(a,c,o)}))}))})(e,H)}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Uy9JLElBdEJNNEosRUFBQzVKLEVBQWFFLEtBQ3RDLE1BQU1PLEVBQVlpSixNQUFNQyxLQUN0QjNKLEVBQVkyRyxpQkFBaUJ6RyxFQUFPUixnQkFFaENnQixFQUFnQlYsRUFBWUcsY0FBY0QsRUFBT1Asc0JBRXZEYSxFQUFrQkMsRUFBV0MsRUFBZVIsR0FFNUNGLEVBQVlzSCxpQkFBaUIsU0FBUyxLQUNwQ3RHLEVBQWNOLEVBQWVSLEVBQU8sSUFHdENPLEVBQVVzSSxTQUFTOUksSUFDakJBLEVBQWFxSCxpQkFBaUIsU0FBUyxXQXBEaEJ1QyxFQUFDN0osRUFBYUMsRUFBY0MsS0FDaERELEVBQWFZLFNBQVNDLE1BUXpCZixFQUFlQyxFQUFhQyxFQUFjQyxHQXpCdkI0SixFQUFDOUosRUFBYUMsRUFBYzhKLEVBQVU3SixLQUNuQ0YsRUFBWUcsY0FDbEMsSUFBSUYsRUFBYUcsWUFFSEMsWUFBYzBKLEVBQzlCOUosRUFBYUssVUFBVVksSUFBSWhCLEVBQU9MLGdCQUFnQixFQWFoRGlLLENBQ0U5SixFQUNBQyxFQUNBQSxFQUFhK0osa0JBQ2I5SixFQUlKLEVBMkNJMkosQ0FBbUI3SixFQUFhQyxFQUFjQyxHQUM5Q00sRUFBa0JDLEVBQVdDLEVBQWVSLEVBQzlDLEdBQUUsR0FDRixFQU1BMEosQ0FBa0I1SixFQUFhRSxFQUFPLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3NjcmlwdHMvdmFsaWRhdGlvbi5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3V0aWxzL2hlbHBlcnMuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3V0aWxzL0FwaS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3Qgc2V0dGluZ3MgPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19zdWJtaXQtYnV0dG9uX2luYWN0aXZlXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvclwiLFxufTtcblxuY29uc3Qgc2hvd0lucHV0RXJyb3IgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgZXJyb3JNc2csIGNvbmZpZykgPT4ge1xuICBjb25zdCBlcnJvck1zZ0VsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxuICApO1xuICBlcnJvck1zZ0VsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1zZztcbiAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XG59O1xuXG5jb25zdCBoaWRlSW5wdXRFcnJvciA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpID0+IHtcbiAgY29uc3QgZXJyb3JNc2dFbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcbiAgKTtcbiAgZXJyb3JNc2dFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcbiAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XG59O1xuXG5jb25zdCBjaGVja0lucHV0VmFsaWRpdHkgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKSA9PiB7XG4gIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgc2hvd0lucHV0RXJyb3IoXG4gICAgICBmb3JtRWxlbWVudCxcbiAgICAgIGlucHV0RWxlbWVudCxcbiAgICAgIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSxcbiAgICAgIGNvbmZpZ1xuICAgICk7XG4gIH0gZWxzZSB7XG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKTtcbiAgfVxufTtcblxuY29uc3QgaGFzSW52YWxpZElucHV0ID0gKGlucHV0TGlzdCkgPT4ge1xuICByZXR1cm4gaW5wdXRMaXN0LnNvbWUoKGlucHV0KSA9PiB7XG4gICAgcmV0dXJuICFpbnB1dC52YWxpZGl0eS52YWxpZDtcbiAgfSk7XG59O1xuXG5jb25zdCB0b2dnbGVCdXR0b25TdGF0ZSA9IChpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZykgPT4ge1xuICBpZiAoaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkpIHtcbiAgICBkaXNhYmxlQnV0dG9uKGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XG4gIH0gZWxzZSB7XG4gICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gIH1cbn07XG5cbmV4cG9ydCBjb25zdCBkaXNhYmxlQnV0dG9uID0gKGJ1dHRvbkVsZW1lbnQsIGNvbmZpZykgPT4ge1xuICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcbiAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbn07XG5cbmV4cG9ydCBjb25zdCByZXNldFZhbGlkYXRpb24gPSAoZm9ybUVsZW1lbnQsIGlucHV0TGlzdCwgY29uZmlnKSA9PiB7XG4gIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbGVtZW50LCBpbnB1dCwgY29uZmlnKTtcbiAgfSk7XG59O1xuXG5jb25zdCBzZXRFdmVudExpc3RlbmVycyA9IChmb3JtRWxlbWVudCwgY29uZmlnKSA9PiB7XG4gIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oXG4gICAgZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuaW5wdXRTZWxlY3RvcilcbiAgKTtcbiAgY29uc3QgYnV0dG9uRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcblxuICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XG5cbiAgZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInJlc2V0XCIsICgpID0+IHtcbiAgICBkaXNhYmxlQnV0dG9uKGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XG4gIH0pO1xuXG4gIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGNoZWNrSW5wdXRWYWxpZGl0eShmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpO1xuICAgICAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpO1xuICAgIH0pO1xuICB9KTtcbn07XG5cbmV4cG9ydCBjb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKGNvbmZpZykgPT4ge1xuICBjb25zdCBmb3JtTGlzdCA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuZm9ybVNlbGVjdG9yKSk7XG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbGVtZW50KSA9PiB7XG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoZm9ybUVsZW1lbnQsIGNvbmZpZyk7XG4gIH0pO1xufTtcbiIsImV4cG9ydCBmdW5jdGlvbiBzZXRCdXR0b25UZXh0KFxuICBidG4sXG4gIGlzTG9hZGluZyxcbiAgZGVmYXVsdFRleHQgPSBcIlNhdmVcIixcbiAgbG9hZGluZ1RleHQgPSBcIlNhdmluZy4uLlwiXG4pIHtcbiAgaWYgKGlzTG9hZGluZykge1xuICAgIGJ0bi50ZXh0Q29udGVudCA9IGxvYWRpbmdUZXh0O1xuICB9IGVsc2Uge1xuICAgIGJ0bi50ZXh0Q29udGVudCA9IGRlZmF1bHRUZXh0O1xuICB9XG59XG5cbi8vIGRlZmluZSBhIHVuaXZlcnNhbCBmdW5jdGlvbiB0aGF0IGFjY2VwdHMgYSByZXF1ZXN0IGZ1bmN0aW9uLCBldmVudCBhbmQgYSBkZWZhdWx0IGxvYWRpbmcgdGV4dFxuZXhwb3J0IGZ1bmN0aW9uIGhhbmRsZVN1Ym1pdChyZXF1ZXN0LCBldnQsIGxvYWRpbmdUZXh0ID0gXCJTYXZpbmcuLi5cIikge1xuICAvLyBZb3UgbmVlZCB0byBwcmV2ZW50IHRoZSBkZWZhdWx0IGFjdGlvbiBpbiBhbnkgc3VibWl0IGhhbmRsZXJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgLy8gdGhlIGJ1dHRvbiBpcyBhbHdheXMgYXZhaWxhYmxlIGluc2lkZSBgZXZlbnRgIGFzIGBzdWJtaXR0ZXJgXG4gIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IGV2dC5zdWJtaXR0ZXI7XG4gIC8vIGZpeCB0aGUgaW5pdGlhbCBidXR0b24gdGV4dFxuICBjb25zdCBpbml0aWFsVGV4dCA9IHN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudDtcbiAgLy8gY2hhbmdlIHRoZSBidXR0b24gdGV4dCBiZWZvcmUgcmVxdWVzdGluZ1xuICBzZXRCdXR0b25UZXh0KHN1Ym1pdEJ1dHRvbiwgdHJ1ZSwgaW5pdGlhbFRleHQsIGxvYWRpbmdUZXh0KTtcbiAgLy8gY2FsbCB0aGUgcmVxdWVzdCBmdW5jdGlvbiB0byBiZSBhYmxlIHRvIHVzZSB0aGUgcHJvbWlzZSBjaGFpblxuICByZXF1ZXN0KClcbiAgICAudGhlbigoKSA9PiB7XG4gICAgICAvLyBhbnkgZm9ybSBzaG91bGQgYmUgcmVzZXQgYWZ0ZXIgYSBzdWNjZXNzZnVsIHJlc3BvbnNlXG4gICAgICAvLyBldnQudGFyZ2V0IGlzIHRoZSBmb3JtIGluIGFueSBzdWJtaXQgaGFuZGxlclxuICAgICAgZXZ0LnRhcmdldC5yZXNldCgpO1xuICAgIH0pXG4gICAgLy8gd2UgbmVlZCB0byBjYXRjaCBwb3NzaWJsZSBlcnJvcnNcbiAgICAvLyBjb25zb2xlLmVycm9yIGlzIHVzZWQgdG8gaGFuZGxlIGVycm9ycyBpZiB5b3UgZG9u4oCZdCBoYXZlIGFueSBvdGhlciB3YXlzIGZvciB0aGF0XG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXG5cbiAgICAvLyBhbmQgaW4gZmluYWxseSB3ZSBuZWVkIHRvIHN0b3AgbG9hZGluZ1xuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIHNldEJ1dHRvblRleHQoc3VibWl0QnV0dG9uLCBmYWxzZSwgaW5pdGlhbFRleHQsIGxvYWRpbmdUZXh0KTtcbiAgICB9KTtcbn1cbiIsImltcG9ydCB7XG4gIGVuYWJsZVZhbGlkYXRpb24sXG4gIHNldHRpbmdzLFxuICByZXNldFZhbGlkYXRpb24sXG4gIGRpc2FibGVCdXR0b24sXG59IGZyb20gXCIuLi9zY3JpcHRzL3ZhbGlkYXRpb24uanNcIjtcbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5pbXBvcnQgc3BvdHNMb2dvQmxhY2sgZnJvbSBcIi4uL0ltYWdlcy9zcG90c19sb2dvX2JsYWNrLnN2Z1wiO1xuaW1wb3J0IEFwaSBmcm9tIFwiLi4vdXRpbHMvQXBpLmpzXCI7XG5pbXBvcnQgeyBzZXRCdXR0b25UZXh0LCBoYW5kbGVTdWJtaXQgfSBmcm9tIFwiLi4vdXRpbHMvaGVscGVycy5qc1wiO1xuXG5sZXQgdXNlcklkO1xubGV0IHNlbGVjdGVkQ2FyZDtcbmxldCBzZWxlY3RlZENhcmRJZDtcblxuLy90aGlzIGlzIGNyZWF0aW5nIHRoZSBtYXN0ZXIgYmFzZXVybCBhbmQgaGVhZGVycyB0aGF0IHdpbGwgYmUgdXNlZCBpbiB0byBidWlsZCBcInRoaXNcIiBpbiB0aGUgQVBJIGNsYXNzXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCJhZmZhZGI3YS00MzMxLTRmZDItODU4Mi1mZmExZjFiYzRiNDlcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgfSxcbn0pO1xuXG4vL3NlbGVjdHMgdGhlIGVkaXQgcHJvZmlsZSBhbmQgbW9kYWxcbmNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcbmNvbnN0IHByb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uYW1lXCIpO1xuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiKTtcbmNvbnN0IHByb2ZpbGVBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhciBpbWdcIik7XG5jb25zdCBwcm9maWxlRWRpdEF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyLWJ1dHRvblwiKTtcbmNvbnN0IGVkaXRQcm9maWxlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VkaXQtcHJvZmlsZS1tb2RhbFwiKTtcblxuLy9zZWxlY3RzIHRoZSBmb3JtIGlucHV0cywgbW9kYWxzXG5jb25zdCBpbnB1dE5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtbmFtZS1pbnB1dFwiKTtcbmNvbnN0IGlucHV0RGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZGVzY3JpcHRpb24taW5wdXRcIik7XG5jb25zdCBwcm9maWxlRm9ybUVsZW1lbnQgPSBlZGl0UHJvZmlsZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG5jb25zdCBwcm9maWxlRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wicHJvZmlsZS1mb3JtXCJdO1xuY29uc3QgcHJvZmlsZUF2YXRhck1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LWF2YXRhci1tb2RhbFwiKTtcbmNvbnN0IGF2YXRhckZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcImF2YXRhci1mb3JtXCJdO1xuY29uc3QgYXZhdGFySW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtcGljdHVyZS1pbnB1dFwiKTsgLy8gR2V0IHRoZSBpbnB1dCBlbGVtZW50XG5cbi8vYmVsb3cgc2VsZWN0cyB0aGUgbmV3IHBvc3QgYW5kIG1vZGFsXG5jb25zdCBuZXdQb3N0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xuY29uc3QgbmV3UG9zdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNuZXctcG9zdC1tb2RhbFwiKTtcbmNvbnN0IG5ld1Bvc3RGb3JtID0gZG9jdW1lbnQuZm9ybXNbXCJuZXdQb3N0LWZvcm1cIl07XG5jb25zdCBuZXdQb3N0TGlua0lucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNuZXdQb3N0LWxpbmstaW5wdXRcIik7XG5jb25zdCBuZXdQb3N0Q2FwdGlvbklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNuZXdQb3N0LWNhcHRpb24taW5wdXRcIik7XG5cbi8vc2VsZWN0cyB0aGUgYnV0dG9uc1xuY29uc3QgY2FyZFN1Ym1pdEJ1dHRvbiA9IG5ld1Bvc3RNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zdWJtaXQtYnV0dG9uXCIpO1xuY29uc3QgZGVsZXRlUG9zdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNkZWxldGUtcG9zdC1tb2RhbFwiKTtcbmNvbnN0IGNsb3NlQnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2Nsb3NlXCIpO1xuXG4vL2JlbG93IHNlbGVjdHMgdGhlIHByZXZpZXcgbGFyZ2VyIGltYWdlIG1vZGFsXG5jb25zdCBwcmV2aWV3TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3ByZXZpZXctbW9kYWxcIik7XG5jb25zdCBwcmV2aWV3TW9kYWxJbWFnZUVsID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xuY29uc3QgcHJldmlld01vZGFsQ2FwdGlvbiA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jYXB0aW9uXCIpO1xuXG4vL3NlbGVjdHMgYWxsIG1vZGFsc1xuY29uc3QgbW9kYWxzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbFwiKTtcblxuLy90aGlzIGlzIGlkZW50aWZ5aW5nIHdoYXQgdGhlIGFjdHVhbCBjYXJkIGlzIGFuZCBiZWxvdyBhcmUgdGhlIGZpZWxkcyBhbmQgaG93IHRoZXkgd2lsbCBiZSBwb3B1bGF0ZWRcbmNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10ZW1wbGF0ZVwiKTtcbmNvbnN0IGNhcmRMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcblxuY29uc3QgZGVsZXRlQ2FyZFN1Ym1pdCA9IGRlbGV0ZVBvc3RNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19kZWxldGUtYnV0dG9uXCIpO1xuY29uc3QgZGVsZXRlQ2FyZENhbmNlbCA9IGRlbGV0ZVBvc3RNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jYW5jZWwtYnV0dG9uXCIpO1xuXG5kb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNwb3RzLWxvZ28tYmxhY2tcIikuc3JjID0gc3BvdHNMb2dvQmxhY2s7XG5cbi8vIEFkZCBjbG9zZSBvbiBvdXRzaWRlIGNsaWNrIGZvciBlYWNoIG1vZGFsXG5tb2RhbHMuZm9yRWFjaCgobW9kYWwpID0+IHtcbiAgY2xvc2VNb2RhbE9uT3V0c2lkZUNsaWNrKG1vZGFsKTtcbn0pO1xuXG4vL1RoaXMgaXMgdW5pdmVyc2FsIGNsb3NlIGJ1dHRvbiBoYW5kbGVyXG5jbG9zZUJ1dHRvbnMuZm9yRWFjaCgoYnV0dG9uKSA9PiB7XG4gIGNvbnN0IG1vZGFsID0gYnV0dG9uLmNsb3Nlc3QoXCIubW9kYWxcIik7XG4gIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gY2xvc2VNb2RhbChtb2RhbCkpO1xufSk7XG5cbi8vdGhlc2UgYXJlIHRoZSB1bml2ZXJzYWwgZnVuY3Rpb25zIGZvciBvcGVuaW5nIGFuZCBjbG9zaW5nIHRoZSBtb2RhbHNcbmZ1bmN0aW9uIG9wZW5Nb2RhbChtb2RhbCkge1xuICBtb2RhbC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xuICAvL2JlbG93IGFkZHMgdGhlIGxpc3RlbmVyIHdoZW4gd2luZG93IGlzIG9wZW5cbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgY2xvc2VNb2RhbE9uRXNjYXBlKTtcbn1cblxuZnVuY3Rpb24gY2xvc2VNb2RhbChtb2RhbCkge1xuICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xuICAvL2JlbG93IHJlbW92ZXMgdGhlIGxpc3RlbmVyIHdoZW4gd2luZG93IGlzIGNsb3NlZFxuICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBjbG9zZU1vZGFsT25Fc2NhcGUpO1xufVxuXG4vLyBVbml2ZXJzYWwgZnVuY3Rpb24gdG8gY2xvc2UgdGhlIG1vZGFsIHdoZW4gY2xpY2tpbmcgb3V0c2lkZSB0aGUgbW9kYWwgY29udGVudFxuZnVuY3Rpb24gY2xvc2VNb2RhbE9uT3V0c2lkZUNsaWNrKG1vZGFsKSB7XG4gIG1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XG4gICAgLy8gQ2hlY2tzIGlmIHRoZSBjbGljayB3YXMgb3V0c2lkZSB0aGUgbW9kYWwgY29udGVudFxuICAgIGlmIChldnQudGFyZ2V0ID09PSBtb2RhbCkge1xuICAgICAgY2xvc2VNb2RhbChtb2RhbCk7XG4gICAgfVxuICB9KTtcbn1cblxuLy8gRnVuY3Rpb24gdG8gY2xvc2UgbW9kYWwgd2hlbiBFc2NhcGUga2V5IGlzIHByZXNzZWRcbmZ1bmN0aW9uIGNsb3NlTW9kYWxPbkVzY2FwZShldnQpIHtcbiAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAvLyBGaW5kIHRoZSBjdXJyZW50bHkgb3BlbiBtb2RhbFxuICAgIGNvbnN0IG9wZW5Nb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfb3BlbmVkXCIpO1xuICAgIGlmIChvcGVuTW9kYWwpIHtcbiAgICAgIGNsb3NlTW9kYWwob3Blbk1vZGFsKTtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gZ2V0Q2FyZEVsZW1lbnQoZGF0YSkge1xuICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmRUZW1wbGF0ZS5jb250ZW50XG4gICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxuICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG5cbiAgY29uc3QgY2FyZE5hbWVFbCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XG4gIGNvbnN0IGNhcmRJbWFnZUVsID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcbiAgY29uc3QgY2FyZExpa2VCdXR0b24gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xuICBjb25zdCBjYXJkRGVsZXRlQnV0dG9uID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnV0dG9uXCIpO1xuXG4gIGNvbnN0IGlzTGlrZWQgPSBkYXRhLmlzTGlrZWQ7XG4gIGlmIChpc0xpa2VkKSB7XG4gICAgY2FyZExpa2VCdXR0b24uY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnV0dG9uX2NsaWNrZWRcIik7XG4gIH1cblxuICBjYXJkTmFtZUVsLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xuICBjYXJkSW1hZ2VFbC5zcmMgPSBkYXRhLmxpbms7XG4gIGNhcmRJbWFnZUVsLmFsdCA9IGRhdGEubmFtZTtcblxuICBjYXJkTGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xuICAgIGhhbmRsZUxpa2UoZXZ0LCBkYXRhLl9pZCk7XG4gIH0pO1xuXG4gIC8vdGhpcyBkZWxldGVzIHRoZSBjYXJkLCB0aGUgY2xvc2VzdCBnb2VzIHRvIHRoZSBuZWFyZXN0IHBhcmVudCAtLS0tLSBtb2RpZmllZCB0aGlzXG4gIGNhcmREZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcbiAgICBoYW5kbGVEZWxldGVDYXJkKGNhcmRFbGVtZW50LCBkYXRhKTtcbiAgfSk7XG5cbiAgLy9mb3IgaW1hZ2UgcHJldmlldyBtb2RhbCAuY2FyZF9faW1hZ2VcbiAgY2FyZEltYWdlRWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICBvcGVuTW9kYWwocHJldmlld01vZGFsKTtcbiAgICBwcmV2aWV3TW9kYWxDYXB0aW9uLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xuICAgIHByZXZpZXdNb2RhbEltYWdlRWwuc3JjID0gZGF0YS5saW5rO1xuICAgIHByZXZpZXdNb2RhbENhcHRpb24uYWx0ID0gZGF0YS5uYW1lO1xuICB9KTtcblxuICByZXR1cm4gY2FyZEVsZW1lbnQ7XG59XG5cbmZ1bmN0aW9uIHJlbmRlckNhcmQoaXRlbSwgbWV0aG9kID0gXCJhcHBlbmRcIikge1xuICBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KGl0ZW0pO1xuICBjYXJkTGlzdFttZXRob2RdKGNhcmRFbGVtZW50KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlQXZhdGFyRm9ybVN1Ym1pdChldnQpIHtcbiAgZnVuY3Rpb24gbWFrZVJlcXVlc3QoKSB7XG4gICAgcmV0dXJuIGFwaS5lZGl0QXZhdGFyKHsgYXZhdGFyOiBhdmF0YXJJbnB1dC52YWx1ZSB9KS50aGVuKChkYXRhKSA9PiB7XG4gICAgICBwcm9maWxlQXZhdGFyLnNyYyA9IGRhdGEuYXZhdGFyO1xuICAgICAgcHJvZmlsZUF2YXRhci5hbHQgPSBkYXRhLm5hbWU7XG4gICAgICBjbG9zZU1vZGFsKHByb2ZpbGVBdmF0YXJNb2RhbCk7XG4gICAgfSk7XG4gIH1cblxuICBoYW5kbGVTdWJtaXQobWFrZVJlcXVlc3QsIGV2dCwgXCJTYXZpbmcuLi5cIik7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZU5ld1Bvc3RTdWJtaXQoZXZ0KSB7XG4gIGZ1bmN0aW9uIG1ha2VSZXF1ZXN0KCkge1xuICAgIHJldHVybiBhcGlcbiAgICAgIC5uZXdDYXJkUG9zdCh7XG4gICAgICAgIGxpbms6IG5ld1Bvc3RMaW5rSW5wdXQudmFsdWUsXG4gICAgICAgIG5hbWU6IG5ld1Bvc3RDYXB0aW9uSW5wdXQudmFsdWUsXG4gICAgICB9KVxuICAgICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgICAgcmVuZGVyQ2FyZChkYXRhLCBcInByZXBlbmRcIik7XG4gICAgICAgIGRpc2FibGVCdXR0b24oY2FyZFN1Ym1pdEJ1dHRvbiwgc2V0dGluZ3MpO1xuICAgICAgICBjbG9zZU1vZGFsKG5ld1Bvc3RNb2RhbCk7XG4gICAgICB9KTtcbiAgfVxuXG4gIGhhbmRsZVN1Ym1pdChtYWtlUmVxdWVzdCwgZXZ0LCBcIlNhdmluZy4uLlwiKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlTGlrZShldnQsIGNhcmRJZCkge1xuICBjb25zdCBsaWtlQnV0dG9uID0gZXZ0LnRhcmdldDtcbiAgY29uc3QgaXNMaWtlZCA9IGxpa2VCdXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKFwiY2FyZF9fbGlrZS1idXR0b25fY2xpY2tlZFwiKTtcblxuICBhcGlcbiAgICAuaGFuZGxlTGlrZSh7IGNhcmRJZDogY2FyZElkLCBpc0xpa2VkOiBpc0xpa2VkIH0pXG4gICAgLnRoZW4oKHVwZGF0ZWRDYXJkKSA9PiB7XG4gICAgICBpZiAodXBkYXRlZENhcmQuaXNMaWtlZCkge1xuICAgICAgICBsaWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ1dHRvbl9jbGlja2VkXCIpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9fbGlrZS1idXR0b25fY2xpY2tlZFwiKTtcbiAgICAgIH1cbiAgICB9KVxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQoZXZ0KSB7XG4gIGZ1bmN0aW9uIG1ha2VSZXF1ZXN0KCkge1xuICAgIHJldHVybiBhcGlcbiAgICAgIC5lZGl0VXNlckluZm8oeyBuYW1lOiBpbnB1dE5hbWUudmFsdWUsIGFib3V0OiBpbnB1dERlc2NyaXB0aW9uLnZhbHVlIH0pXG4gICAgICAudGhlbigodXNlckRhdGEpID0+IHtcbiAgICAgICAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSB1c2VyRGF0YS5uYW1lO1xuICAgICAgICBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSB1c2VyRGF0YS5hYm91dDtcbiAgICAgICAgY2xvc2VNb2RhbChlZGl0UHJvZmlsZU1vZGFsKTtcbiAgICAgIH0pO1xuICB9XG4gIGhhbmRsZVN1Ym1pdChtYWtlUmVxdWVzdCwgZXZ0LCBcIlNhdmluZy4uLlwiKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlQ2FyZChjYXJkRWxlbWVudCwgZGF0YSkge1xuICBzZWxlY3RlZENhcmQgPSBjYXJkRWxlbWVudDtcbiAgc2VsZWN0ZWRDYXJkSWQgPSBkYXRhLl9pZDtcbiAgY29uc29sZS5sb2coXCJTZWxlY3RlZCBDYXJkIElEOlwiLCBzZWxlY3RlZENhcmRJZCk7XG4gIG9wZW5Nb2RhbChkZWxldGVQb3N0TW9kYWwpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVTdWJtaXQoZXZ0KSB7XG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICBjb25zdCBzdWJtaXRCdG4gPSBldnQudGFyZ2V0O1xuICBzZXRCdXR0b25UZXh0KHN1Ym1pdEJ0biwgdHJ1ZSwgXCJEZWxldGVcIiwgXCJEZWxldGluZy4uLlwiKTtcbiAgYXBpXG4gICAgLmRlbGV0ZUNhcmQoeyBjYXJkSWQ6IHNlbGVjdGVkQ2FyZElkIH0pXG4gICAgLnRoZW4oKCkgPT4ge1xuICAgICAgc2VsZWN0ZWRDYXJkLnJlbW92ZSgpO1xuICAgICAgY2xvc2VNb2RhbChkZWxldGVQb3N0TW9kYWwpO1xuICAgIH0pXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgc2V0QnV0dG9uVGV4dChzdWJtaXRCdG4sIGZhbHNlLCBcIkRlbGV0ZVwiLCBcIkRlbGV0aW5nLi4uXCIpO1xuICAgIH0pO1xufVxuXG4vL3RoaXMgaXMgbGlzdGVuaW5nIGZvciB0aGUgY2xpY2sgdGhlbiBwdWxsaW5nIHVwIHRoZSBkYXRhIHRoYXQncyBpbiB0aGUgaW5wdXQgZmllbGRzXG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBpbnB1dE5hbWUudmFsdWUgPSBwcm9maWxlTmFtZS50ZXh0Q29udGVudDtcbiAgaW5wdXREZXNjcmlwdGlvbi52YWx1ZSA9IHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudDtcbiAgcmVzZXRWYWxpZGF0aW9uKGVkaXRQcm9maWxlTW9kYWwsIFtpbnB1dE5hbWUsIGlucHV0RGVzY3JpcHRpb25dLCBzZXR0aW5ncyk7XG4gIG9wZW5Nb2RhbChlZGl0UHJvZmlsZU1vZGFsKTtcbn0pO1xuXG4vL3RoZXNlIGFyZSBqdXN0IGZvciBvcGVuaW5nIGFuZCBjbG9zaW5nIGZvciB0aGUgYnV0dG9uc1xubmV3UG9zdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBvcGVuTW9kYWwobmV3UG9zdE1vZGFsKTtcbn0pO1xuXG5wcm9maWxlRWRpdEF2YXRhci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBvcGVuTW9kYWwocHJvZmlsZUF2YXRhck1vZGFsKTtcbn0pO1xuXG4vL3RoZXNlIGFyZSB0aGUgZXZlbnQgbGlzdGVuZXIgZm9yIHRoZSBhYm92ZSBmdW5jdGlvbnNcbnByb2ZpbGVGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQpO1xubmV3UG9zdEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVOZXdQb3N0U3VibWl0KTtcbmF2YXRhckZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVBdmF0YXJGb3JtU3VibWl0KTtcblxuZGVsZXRlQ2FyZFN1Ym1pdC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlRGVsZXRlU3VibWl0KTtcblxuZGVsZXRlQ2FyZENhbmNlbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gY2xvc2VNb2RhbChkZWxldGVQb3N0TW9kYWwpKTtcblxuYXBpXG4gIC5nZXRBcHBJbmZvKClcbiAgLnRoZW4oKFtjYXJkcywgdXNlckRhdGFdKSA9PiB7XG4gICAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSB1c2VyRGF0YS5uYW1lO1xuICAgIHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IHVzZXJEYXRhLmFib3V0O1xuICAgIHByb2ZpbGVBdmF0YXIuc3JjID0gdXNlckRhdGEuYXZhdGFyO1xuICAgIHByb2ZpbGVBdmF0YXIuYWx0ID0gdXNlckRhdGEubmFtZTtcbiAgICB1c2VySWQgPSB1c2VyRGF0YS5faWQ7XG4gICAgY2FyZHMucmV2ZXJzZSgpLmZvckVhY2goKGNhcmQpID0+IHtcbiAgICAgIHJlbmRlckNhcmQoY2FyZCk7XG4gICAgfSk7XG4gIH0pXG4gIC5jYXRjaChjb25zb2xlLmVycm9yKTtcblxuZW5hYmxlVmFsaWRhdGlvbihzZXR0aW5ncyk7XG4iLCJjbGFzcyBBcGkge1xuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xuICB9XG5cbiAgZ2V0QXBwSW5mbygpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuZ2V0SW5pdGlhbENhcmRzKCksIHRoaXMuZ2V0VXNlckluZm8oKV0pO1xuICB9XG5cbiAgX2NoZWNrUmVzcG9uc2UocmVzKSB7XG4gICAgaWYgKHJlcy5vaykge1xuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgfVxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3IgJHtyZXMuc3RhdHVzfWApO1xuICB9XG5cbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGVkaXRVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWUsXG4gICAgICAgIGFib3V0LFxuICAgICAgfSksXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGVkaXRBdmF0YXIoeyBhdmF0YXIgfSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIGF2YXRhcixcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBuZXdDYXJkUG9zdCh7IG5hbWUsIGxpbmsgfSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lLFxuICAgICAgICBsaW5rLFxuICAgICAgfSksXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGRlbGV0ZUNhcmQoeyBjYXJkSWQgfSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBoYW5kbGVMaWtlKHsgY2FyZElkLCBpc0xpa2VkIH0pIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xuICAgICAgbWV0aG9kOiBpc0xpa2VkID8gXCJERUxFVEVcIiA6IFwiUFVUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgQXBpO1xuIl0sIm5hbWVzIjpbInNldHRpbmdzIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJoaWRlSW5wdXRFcnJvciIsImZvcm1FbGVtZW50IiwiaW5wdXRFbGVtZW50IiwiY29uZmlnIiwicXVlcnlTZWxlY3RvciIsImlkIiwidGV4dENvbnRlbnQiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImlucHV0TGlzdCIsImJ1dHRvbkVsZW1lbnQiLCJzb21lIiwiaW5wdXQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiaGFzSW52YWxpZElucHV0IiwiZGlzYWJsZUJ1dHRvbiIsImRpc2FibGVkIiwiYWRkIiwic2V0QnV0dG9uVGV4dCIsImJ0biIsImlzTG9hZGluZyIsImRlZmF1bHRUZXh0IiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwibG9hZGluZ1RleHQiLCJoYW5kbGVTdWJtaXQiLCJyZXF1ZXN0IiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJzdWJtaXRCdXR0b24iLCJzdWJtaXR0ZXIiLCJpbml0aWFsVGV4dCIsInRoZW4iLCJ0YXJnZXQiLCJyZXNldCIsImNhdGNoIiwiY29uc29sZSIsImVycm9yIiwiZmluYWxseSIsInVzZXJJZCIsInNlbGVjdGVkQ2FyZCIsInNlbGVjdGVkQ2FyZElkIiwiYXBpIiwiY29uc3RydWN0b3IiLCJfcmVmIiwiYmFzZVVybCIsImhlYWRlcnMiLCJ0aGlzIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsImdldEFwcEluZm8iLCJQcm9taXNlIiwiYWxsIiwiZ2V0SW5pdGlhbENhcmRzIiwiZ2V0VXNlckluZm8iLCJfY2hlY2tSZXNwb25zZSIsInJlcyIsIm9rIiwianNvbiIsInJlamVjdCIsInN0YXR1cyIsImZldGNoIiwiZWRpdFVzZXJJbmZvIiwiX3JlZjIiLCJuYW1lIiwiYWJvdXQiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImVkaXRBdmF0YXIiLCJfcmVmMyIsImF2YXRhciIsIm5ld0NhcmRQb3N0IiwiX3JlZjQiLCJsaW5rIiwiZGVsZXRlQ2FyZCIsIl9yZWY1IiwiY2FyZElkIiwiaGFuZGxlTGlrZSIsIl9yZWY2IiwiaXNMaWtlZCIsImF1dGhvcml6YXRpb24iLCJwcm9maWxlRWRpdEJ1dHRvbiIsImRvY3VtZW50IiwicHJvZmlsZU5hbWUiLCJwcm9maWxlRGVzY3JpcHRpb24iLCJwcm9maWxlQXZhdGFyIiwicHJvZmlsZUVkaXRBdmF0YXIiLCJlZGl0UHJvZmlsZU1vZGFsIiwiaW5wdXROYW1lIiwiaW5wdXREZXNjcmlwdGlvbiIsInByb2ZpbGVGb3JtIiwiZm9ybXMiLCJwcm9maWxlQXZhdGFyTW9kYWwiLCJhdmF0YXJGb3JtIiwiYXZhdGFySW5wdXQiLCJuZXdQb3N0QnV0dG9uIiwibmV3UG9zdE1vZGFsIiwibmV3UG9zdEZvcm0iLCJuZXdQb3N0TGlua0lucHV0IiwibmV3UG9zdENhcHRpb25JbnB1dCIsImNhcmRTdWJtaXRCdXR0b24iLCJkZWxldGVQb3N0TW9kYWwiLCJjbG9zZUJ1dHRvbnMiLCJxdWVyeVNlbGVjdG9yQWxsIiwicHJldmlld01vZGFsIiwicHJldmlld01vZGFsSW1hZ2VFbCIsInByZXZpZXdNb2RhbENhcHRpb24iLCJtb2RhbHMiLCJjYXJkVGVtcGxhdGUiLCJjYXJkTGlzdCIsImRlbGV0ZUNhcmRTdWJtaXQiLCJkZWxldGVDYXJkQ2FuY2VsIiwib3Blbk1vZGFsIiwibW9kYWwiLCJhZGRFdmVudExpc3RlbmVyIiwiY2xvc2VNb2RhbE9uRXNjYXBlIiwiY2xvc2VNb2RhbCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJrZXkiLCJyZW5kZXJDYXJkIiwiaXRlbSIsImNhcmRFbGVtZW50IiwiZGF0YSIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJjYXJkTmFtZUVsIiwiY2FyZEltYWdlRWwiLCJjYXJkTGlrZUJ1dHRvbiIsImNhcmREZWxldGVCdXR0b24iLCJzcmMiLCJhbHQiLCJsaWtlQnV0dG9uIiwiY29udGFpbnMiLCJ1cGRhdGVkQ2FyZCIsIl9pZCIsImxvZyIsImhhbmRsZURlbGV0ZUNhcmQiLCJnZXRDYXJkRWxlbWVudCIsImdldEVsZW1lbnRCeUlkIiwiZm9yRWFjaCIsImNsb3NlTW9kYWxPbk91dHNpZGVDbGljayIsImJ1dHRvbiIsImNsb3Nlc3QiLCJyZXNldFZhbGlkYXRpb24iLCJ2YWx1ZSIsInVzZXJEYXRhIiwic3VibWl0QnRuIiwiY2FyZHMiLCJyZXZlcnNlIiwiY2FyZCIsIkFycmF5IiwiZnJvbSIsInNldEV2ZW50TGlzdGVuZXJzIiwiY2hlY2tJbnB1dFZhbGlkaXR5Iiwic2hvd0lucHV0RXJyb3IiLCJlcnJvck1zZyIsInZhbGlkYXRpb25NZXNzYWdlIl0sInNvdXJjZVJvb3QiOiIifQ==